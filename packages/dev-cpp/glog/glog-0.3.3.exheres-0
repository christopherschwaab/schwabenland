# Copyright 2014 <name>
# Distributed under the terms of the GNU General Public License v2

require googlecode [ project=google-glog suffix=tar.gz ] \
        autotools [ supported_autoconf=[ 2.5 ] supported_automake=[ 1.12 ] ]

SUMMARY="A library for application-level logging."
DESCRIPTION="
The library provides logging APIs based on C++-style streams and various helper macros.
"
HOMEPAGE="https://code.google.com/p/google-glog/"

LICENCES=""
SLOT="0"
PLATFORMS="~x86 ~amd64"
MYOPTIONS="
    gflags [[ description = [ Enable command line flags. ] ]]
"

DEPENDENCIES="
    build+run:
        dev-libs/libunwind
        gflags? ( dev-cpp/gflags )
"

BUGS_TO="christopher.schwaab@gmail.com"

# FIXME gmock explicitly says it shouldn't be installed
RESTRICT=( test )

AT_M4DIR=( m4 )

src_prepare() {
    for f in demangle signalhandler logging; do
        sed -i 's/[[:space:]]ParseCommandLineFlags/gflags::ParseCommandLineFlags/' \
            src/${f}_unittest.cc
    done
    sed -i 's/[[:space:]]FlagSaver/gflags::FlagSaver/g' src/logging_unittest.cc
}
