# Copyright 2014 Christopher Schwaab
# Distributed under the terms of the GNU General Public License v2

_REL=luna-SR1
SUMMARY="An IDE for Java developers."
DESCRIPTION="
The essential tools for any Java developer, including a Java IDE, a CVS client, Git client, XML
Editor, Mylyn, Maven integration and Window Builder.
"
HOMEPAGE="https://www.eclipse.org/"
DOWNLOADS="
    platform:amd64? ( http://www.mirrorservice.org/sites/download.eclipse.org/eclipseMirror/technology/epp/downloads/release/${_REL/-/\/}/eclipse-java-${_REL}-linux-gtk-x86_64.tar.gz )
    platform:x86? ( http://www.mirrorservice.org/sites/download.eclipse.org/eclipseMirror/technology/epp/downloads/release/${_REL/-/\/}/eclipse-java-${_REL}-linux-gtk-x86.tar.gz )
"

LICENCES="EPL-1.0"
SLOT="0"
PLATFORMS="~amd64 ~x86"
MYOPTIONS="
    platform: amd64 x86
"

DEPENDENCIES="
    build+run:
        || ( dev-lang/icedtea7 virtual/jre )
        x11-libs/gtk+
"

BUGS_TO="christopher.schwaab@gmail.com"
WORK="${WORKBASE}/eclipse"

src_install() {
    for f in $(find plugins -name 'eclipse*.png'); do
        SIZE=$(echo `basename $f` | grep -o '[[:digit:]]*')
        if [ ! -z "$SIZE" ]; then
            insinto /usr/share/icons/hicolor/${SIZE}x${SIZE}/apps/
            newins "$f" eclipse.png
        fi
    done

    insinto /usr/${LIBDIR}/eclipse
    doins -r \
        about_files \
        configuration \
        features \
        p2 \
        plugins \
        readme \
        about.html \
        artifacts.xml \
        eclipse.ini \
        epl-v10.html \
        icon.xpm \
        notice.html
    keepdir /usr/${LIBDIR}/eclipse/dropins

    exeinto /usr/${LIBDIR}/eclipse
    doexe eclipse

    dobin ${FILES}/eclipse
}
